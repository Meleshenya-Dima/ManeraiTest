ОБЩЕЕ 

1. Движение персонажа
Класс: CharacterControllerMovement + PlayerMovementController
Принцип работы:
•	Используется CharacterController для физического движения, что позволяет обрабатывать столкновения с окружающей средой без Rigidbody.
•	Игрок получает ввод через интерфейс IPlayerInputReader (WASD, стрелки или джойстик).
•	Движение делится на:
o	Поворот: по оси X (A/D), мгновенно вращает персонажа вокруг вертикали.
o	Вперед/назад: по оси Z, движение основано на transform.forward.
o	Скорость: moveSpeed для вперед и backwardSpeed для назад.
•	При отпускании клавиш движение мгновенно останавливается.
•	Для анимации скорость передаётся через CurrentSpeed.
Особенности:
•	Нет скольжения после отпускания клавиш — velocity обнуляется.
•	Поддержка поворота и движения отдельно.
•	Возможность расширения на боковое движение.
________________________________________
2. Анимации и Animator
Класс: PlayerAnimatorController
Принцип работы:
•	Используется Animator с Blend Tree по параметру Speed.
•	Speed = 0 → Idle, Speed > 0 → WalkForward, Speed < 0 → WalkBackward.
•	Скорость передаётся из движения через UpdateAnimation(float speed).
Особенности:
•	При малой скорости (<0.01f) анимация мгновенно переходит в Idle.
•	Blend Tree позволяет плавно смешивать анимации движения.
•	Система полностью контролируется кодом движения (root motion отключён).
________________________________________
3. Система атак
Классы:
•	AttackData — хранит данные одной атаки (анимация, длительность, окно удара, урон, VFX/SFX).
•	HitboxController — управляет коллайдером для удара.
•	AttackExecutor — активирует хитбоксы и обрабатывает попадания.
•	PlayerCombatController — логика комбо и входов.
Принцип работы:
•	Атака запускается через ExecuteAttack(AttackData).
•	Для каждой атаки задаются:
o	duration — общая длительность анимации.
o	hitWindowStart / hitWindowEnd — окно, когда коллайдер активен.
o	damage и hitForce — сила удара.
o	hitVfxPrefab и hitSfx — визуальный и аудиофидбек.
•	Хитбокс включается только в активное окно удара, отключается сразу после.
•	Попадания по врагам фиксируются один раз за атаку (через HashSet damagedReceivers).
•	VFX и SFX создаются при попадании.
Особенности:
•	Мгновенное включение и отключение хитбоксов.
•	Поддержка нескольких хитбоксов на одну атаку.
•	Отладочные Gizmo показывают активный хитбокс и место попадания.
•	Все эффекты создаются в сцене (без ошибок “persistent object”).
________________________________________
4. Комбо система
Класс: PlayerCombatController
Принцип работы:
•	Комбо — это последовательность атак, заданная через List<AttackData> (comboSequence).
•	Игрок может вводить следующую атаку в окне comboInputWindow после текущей.
•	Система учитывает:
o	Текущее состояние комбо (currentStep).
o	Возможность поставить атаку в очередь (canQueueNext).
o	Время окончания предыдущей атаки (lastAttackEndTime).
•	После отпускания клавиши атака продолжается до конца, потом мгновенно переходит в Idle (если Speed = 0).
Особенности:
•	Поддержка максимум N шагов комбо (maxComboStep).
•	Можно запускать любую атаку по индексу для тестирования.
•	Комбо полностью синхронизировано с анимацией и окнами попаданий.
________________________________________
5. Принципы системы
1.	Синхронизация анимации и ударов
o	Время активации хитбоксов строго соответствует hitWindowStart / hitWindowEnd.
o	Урон и эффекты происходят точно в момент удара.
2.	Безопасность и контроль
o	Каждый враг получает урон один раз за атаку.
o	Хитбоксы не остаются активными дольше положенного времени.
3.	Модульность
o	Любая атака хранится в ScriptableObject (AttackData) — легко добавлять новые атаки без изменения кода.
o	Hitbox и Executor отделены от логики комбо и движения.
4.	Отладка
o	В сцене можно видеть активные хитбоксы (красная сфера и линия).
o	Логи позволяют отслеживать попадания и активацию хитбоксов.
5.	Плавность
o	Movement и анимации плавно интегрированы через Blend Tree и CurrentSpeed.
o	Idle и Walk переключаются мгновенно после отпускания клавиш.
6.	Расширяемость
o	Можно легко добавить:
	Разные типы атак (силовые, с разными хитбоксами).
	Эффекты при попадании (VFX/SFX).
	Разные персонажи с индивидуальными анимациями и скоростями.

О АРХИТЕКТУРЕ
1. Движение персонажа
Классы:
•	CharacterControllerMovement
•	PlayerMovementController
Принцип работы:
•	CharacterControllerMovement отвечает только за физическое движение и поворот.
•	PlayerMovementController отвечает за получение ввода и обновление анимации.
Принципы SOLID:
•	SRP (Single Responsibility Principle):
Каждый класс отвечает за одну вещь: движение или обработку ввода.
•	DIP (Dependency Inversion Principle):
PlayerMovementController зависит от интерфейсов (IPlayerInputReader, IMovementHandler) вместо конкретных реализаций.
Паттерны:
•	Strategy: через интерфейсы IMovementHandler и IPlayerInputReader можно менять реализацию движения и ввода без изменения контроллера.
•	Composition over Inheritance: MovementController использует компоненты для движения и анимации.
________________________________________
2. Анимации и Animator
Класс: PlayerAnimatorController
•	Управляет Blend Tree через параметр Speed.
•	Мгновенный переход в Idle, если скорость почти 0.
Принципы SOLID:
•	SRP: класс только обновляет анимацию, не знает о логике движения.
•	OCP (Open/Closed Principle): можно расширять анимации (добавлять новые Blend Tree) без изменения кода.
Паттерны:
•	Facade: упрощает работу с Animator через метод UpdateAnimation().
________________________________________
3. Система атак
Классы: AttackData, HitboxController, AttackExecutor, PlayerCombatController
Принцип работы:
•	AttackData — данные одной атаки (ScriptableObject) → хранит анимацию, урон, VFX/SFX, окно удара.
•	HitboxController — отдельный компонент, который реагирует на столкновения и вызывает события OnHit.
•	AttackExecutor — управляет хитбоксами и вызывает эффекты/урон.
•	PlayerCombatController — управляет комбо и вводом игрока.
Принципы SOLID:
•	SRP: каждый класс отвечает за одну вещь.
•	OCP: легко добавлять новые атаки через ScriptableObject.
•	LSP (Liskov Substitution Principle): IHitReceiver позволяет любому объекту получать урон.
•	DIP: AttackExecutor зависит от абстракции IHitReceiver, а не конкретного врага.
•	ISP (Interface Segregation): IHitReceiver минимальный интерфейс для получения урона.
Паттерны:
•	Observer: через событие OnHit хитбокс сообщает Executor о попадании.
•	Command: AttackExecutor.ExecuteAttack() можно рассматривать как команду “выполнить атаку”.
•	Prototype: AttackData через ScriptableObject — шаблон для создания множества атак без дублирования кода.
________________________________________
4. Комбо система
Класс: PlayerCombatController
•	Управляет последовательностью атак.
•	Позволяет очередное выполнение комбо в окне comboInputWindow.
Принципы SOLID:
•	SRP: контроллер только управляет очередностью атак.
•	OCP: можно расширять комбо, не меняя сам класс.
Паттерны:
•	State / Finite State Machine:
Комбо ведёт себя как конечный автомат: Idle → Attack1 → Attack2 → Attack3 → Idle.
•	Command: нажатие кнопки генерирует команду “выполнить атаку”.
________________________________________
5. Визуальные и звуковые эффекты
Принцип работы:
•	VFX/SFX создаются при попадании (Instantiate(hitVfxPrefab) / AudioSource.PlayOneShot).
•	Можно использовать hitVfxParent для группировки эффектов в сцене.
Принципы SOLID:
•	SRP: AttackExecutor только вызывает эффекты и урон.
•	OCP: новые эффекты можно добавлять через ScriptableObject без изменения кода.
Паттерны:
•	Observer: хитбокс уведомляет о попадании.
•	Prototype: Prefab VFX используется как шаблон.
________________________________________
6. Архитектурные принципы всей системы
1.	Модульность и разделение ответственности
o	Движение, анимация, комбо, удар и эффекты — разные компоненты.
2.	Инверсии зависимостей
o	Контроллеры используют интерфейсы (IMovementHandler, IHitReceiver) → легко заменяемые реализации.
3.	События вместо прямых вызовов
o	HitboxController.OnHit → AttackExecutor → враг получает урон.
4.	ScriptableObject для данных
o	Атаки и комбо можно редактировать без изменения кода.
5.	Blend Tree для плавной анимации
o	Параметр Speed управляет переходом между Idle / WalkForward / WalkBack.
6.	Комбо как State Machine
o	Каждая атака — состояние, переход зависит от ввода игрока и времени.


ССЫЛКИ
[Human Character Dummy | Characters | Unity Asset Store](https://assetstore.unity.com/packages/3d/characters/humanoids/humans/human-character-dummy-178395)
[Mixamo](https://www.mixamo.com/#/)
[Newsfeed - Sketchfab](https://sketchfab.com/3d-models/arena-fcd68db308a349ec8cb42641376262c8)
[Newsfeed - Sketchfab](https://sketchfab.com/3d-models/arena-fcd68db308a349ec8cb42641376262c8)
То или иное решение во время разработки могут быть мною объяснены.
